!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){var a=$(".search-text").val().replace(/^\s*(.*?)\s*$/,"$1");a?o.search(a,function(a){$(".search-results").html(a.map(function(a){return'<div class="search-result-city">'+a+"</div>"}))}):$(".search-results").empty()}function e(){var a=$(this).text();$(".search-text").val(""),$(".search-results").empty();var b=new p(a);b.getTimezone(function(){r.push(b),h()})}function f(){var a=$(this).closest(".clock").data("obj");a.name=prompt("Rename clock",a.name),h()}function g(){var a=$(this).closest(".clock").data("obj");if(confirm('Are you sure you want to delete "'+a.name+'"?')){var b=r.indexOf(a);b>=0&&(r.splice(b,1),h())}}function h(){$(".clocks").html([j()].concat(r).sort(k).map(s.clock)),m(),i()}function i(){var a,b=new Date;b.setMinutes(b.getMinutes()+b.getTimezoneOffset()),b=b.getTime(),$(".clock").each(function(){var c=$(this),d=c.data("obj");d.timezone;a=d.getDate(b),c.find(".clock-time").html(n(a.getHours())+":"+n(a.getMinutes()))})}function j(){return new p({name:"Local",city:"",timezone:-((new Date).getTimezoneOffset()/60),cls:"clock-local"})}function k(a,b){return a.timezone-b.timezone}function l(){function a(){if(b.length){var c=b.shift(),d=new p(c);r.push(d),h(),a()}}if(window.localStorage){var b=JSON.parse(localStorage.getItem("clocks")||"[]");a()}}function m(){window.localStorage&&localStorage.setItem("clocks",JSON.stringify(r))}function n(a){return("0"+a).substr(-2)}var o=a("./models/cities.js"),p=a("./models/Clock.js"),q=a("./utils/tmpl.js"),r=[],s={clock:q($("#clock-tmpl").html())};$(".search-text").on("keyup",d),$(".search-results").on("click",".search-result-city",e),$(".clocks").on("click",".clock-action-rename",f).on("click",".clock-action-delete",g),l(),h(),setInterval(i,1e3)},{"./models/Clock.js":2,"./models/cities.js":3,"./utils/tmpl.js":4}],2:[function(a,b,c){b.exports=function(a){var b=this,c=new Date;b.name="---",b.city=null,"string"==typeof a&&(a={city:a});for(var d in a)b[d]=a[d];b.getLocation=function(a){$.get("http://maps.googleapis.com/maps/api/geocode/json",{address:b.city,sensor:!1},function(c){var d=c.results[0].geometry.location;b.lat=d.lat,b.lng=d.lng,a&&a()})},b.getTimezone=function(a){return b.lat&&b.lng?void $.get("https://maps.googleapis.com/maps/api/timezone/json",{location:b.lat+","+b.lng,timestamp:Math.round((new Date).getTime()/1e3),sensor:!1},function(c){b.timezone=c.rawOffset/3600+c.dstOffset/3600,a&&a()}):b.getLocation(function(){b.getTimezone(a)})},b.getDate=function(a){return c.setTime(a),c.setHours(c.getHours()+(b.timezone||0)),c}}},{}],3:[function(a,b,c){b.exports={search:function(a,b){$.getJSON("http://gd.geobytes.com/AutoCompleteCity?callback=?",{q:a},function(a){b(a)})}}},{}],4:[function(a,b,c){b.exports=function(a){return function(b){return $(a.replace(/\{\{(\w+)\}\}/g,function(a,c){return b[c]||""})).data("obj",b)}}},{}]},{},[1]);